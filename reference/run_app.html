<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run the spatialLIBD Shiny Application — run_app • spatialLIBD</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Run the spatialLIBD Shiny Application — run_app"><meta property="og:description" content="This function runs the shiny application that allows users to interact
with the Visium spatial transcriptomics data from LIBD (by default) or
any other data that you have shaped according to our object structure."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialLIBD</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.13.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/spatialLIBD.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/TenX_data_download.html">Using spatialLIBD with 10x Genomics public datasets</a>
    </li>
    <li>
      <a href="../articles/guide_to_spatial_registration.html">Guide to Spatial Registration</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/LieberInstitute/spatialLIBD/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run the spatialLIBD Shiny Application</h1>
    <small class="dont-index">Source: <a href="https://github.com/LieberInstitute/spatialLIBD/blob/HEAD/R/run_app.R" class="external-link"><code>R/run_app.R</code></a></small>
    <div class="hidden name"><code>run_app.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function runs the shiny application that allows users to interact
with the Visium spatial transcriptomics data from LIBD (by default) or
any other data that you have shaped according to our object structure.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_app</span><span class="op">(</span></span>
<span>  spe <span class="op">=</span> <span class="fu"><a href="fetch_data.html">fetch_data</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"spe"</span><span class="op">)</span>,</span>
<span>  sce_layer <span class="op">=</span> <span class="fu"><a href="fetch_data.html">fetch_data</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"sce_layer"</span><span class="op">)</span>,</span>
<span>  modeling_results <span class="op">=</span> <span class="fu"><a href="fetch_data.html">fetch_data</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"modeling_results"</span><span class="op">)</span>,</span>
<span>  sig_genes <span class="op">=</span> <span class="fu"><a href="sig_genes_extract_all.html">sig_genes_extract_all</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sce_layer</span><span class="op">)</span>, modeling_results <span class="op">=</span></span>
<span>    <span class="va">modeling_results</span>, sce_layer <span class="op">=</span> <span class="va">sce_layer</span><span class="op">)</span>,</span>
<span>  docs_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"app"</span>, <span class="st">"www"</span>, package <span class="op">=</span> <span class="st">"spatialLIBD"</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"spatialLIBD"</span>,</span>
<span>  spe_discrete_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spatialLIBD"</span>, <span class="st">"GraphBased"</span>, <span class="st">"ManualAnnotation"</span>, <span class="st">"Maynard"</span>,</span>
<span>    <span class="st">"Martinowich"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"SNN_k50_k"</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">28</span><span class="op">)</span>, <span class="st">"SpatialDE_PCA"</span>, <span class="st">"SpatialDE_pool_PCA"</span>,</span>
<span>    <span class="st">"HVG_PCA"</span>, <span class="st">"pseudobulk_PCA"</span>, <span class="st">"markers_PCA"</span>, <span class="st">"SpatialDE_UMAP"</span>, <span class="st">"SpatialDE_pool_UMAP"</span>,</span>
<span>    <span class="st">"HVG_UMAP"</span>, <span class="st">"pseudobulk_UMAP"</span>, <span class="st">"markers_UMAP"</span>, <span class="st">"SpatialDE_PCA_spatial"</span>,</span>
<span>    <span class="st">"SpatialDE_pool_PCA_spatial"</span>, <span class="st">"HVG_PCA_spatial"</span>, <span class="st">"pseudobulk_PCA_spatial"</span>,</span>
<span>    <span class="st">"markers_PCA_spatial"</span>, <span class="st">"SpatialDE_UMAP_spatial"</span>, <span class="st">"SpatialDE_pool_UMAP_spatial"</span>,</span>
<span>    <span class="st">"HVG_UMAP_spatial"</span>, <span class="st">"pseudobulk_UMAP_spatial"</span>, </span>
<span>     <span class="st">"markers_UMAP_spatial"</span><span class="op">)</span>,</span>
<span>  spe_continuous_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cell_count"</span>, <span class="st">"sum_umi"</span>, <span class="st">"sum_gene"</span>, <span class="st">"expr_chrM"</span>,</span>
<span>    <span class="st">"expr_chrM_ratio"</span><span class="op">)</span>,</span>
<span>  default_cluster <span class="op">=</span> <span class="st">"spatialLIBD"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>spe</dt>
<dd><p>Defaults to the output of
<code>fetch_data(type = 'spe')</code>. This is a
<a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment.html" class="external-link">SpatialExperiment-class</a>
object with the spot-level Visium data and information required for
visualizing the histology. See <code><a href="fetch_data.html">fetch_data()</a></code> for more details.</p></dd>


<dt>sce_layer</dt>
<dd><p>Defaults to the output of
<code>fetch_data(type = 'sce_layer')</code>. This is a
SingleCellExperiment
object with the spot-level Visium data compressed via pseudo-bulking to the
layer-level (group-level) resolution. See <code><a href="fetch_data.html">fetch_data()</a></code> for more details.</p></dd>


<dt>modeling_results</dt>
<dd><p>Defaults to the output of
<code>fetch_data(type = 'modeling_results')</code>. This is a list of tables with the
columns <code>f_stat_*</code> or <code>t_stat_*</code> as well as <code>p_value_*</code> and <code>fdr_*</code> plus
<code>ensembl</code>. The column name is used to extract the statistic results, the
p-values, and the FDR adjusted p-values. Then the <code>ensembl</code> column is used
for matching in some cases. See <code><a href="fetch_data.html">fetch_data()</a></code> for more details.</p></dd>


<dt>sig_genes</dt>
<dd><p>The output of <code><a href="sig_genes_extract_all.html">sig_genes_extract_all()</a></code> which is a table
in long format with the modeling results. You can subset this if the object
requires too much memory.</p></dd>


<dt>docs_path</dt>
<dd><p>A <code>character(1)</code> specifying the path to the directory
containing the website documentation files. The directory has to contain
the files: <code>documentation_sce_layer.md</code>, <code>documentation_spe.md</code>,
<code>favicon.ico</code>, <code>footer.html</code> and <code>README.md</code>.</p></dd>


<dt>title</dt>
<dd><p>A character(1) specifying the title for the app.</p></dd>


<dt>spe_discrete_vars</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> vector of discrete variables that
will be available to visualize in the app. Basically, the set of variables
with spot-level groups. They will have to be present in <code>colData(spe)</code>.</p></dd>


<dt>spe_continuous_vars</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> vector of continuous variables
that will be available to visualize in the app using the same scale
as genes. They will have to be present in <code>colData(sce)</code>.</p></dd>


<dt>default_cluster</dt>
<dd><p>A <code>character(1)</code> with the name of the main cluster
(discrete) variable to use. It will have to be present in both <code>colData(spe)</code>
and <code>colData(sce_layer)</code>.</p></dd>


<dt>...</dt>
<dd><p>Other arguments passed to the list of golem options for running
the application.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <a href="https://rdrr.io/pkg/shiny/man/shiny.appobj.html" class="external-link">shiny.appobj</a> that contains the input data.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>If you don't have the pseudo-bulked analysis results like we computed them
in our project <a href="https://doi.org/10.1038/s41593-020-00787-0" class="external-link">https://doi.org/10.1038/s41593-020-00787-0</a> you can
set <code>sce_layer</code>, <code>modeling_results</code> and <code>sig_genes</code> to <code>NULL</code>. Doing so
will disable the pseudo-bulked portion of the web application. See the
examples for one such case as well as the vignette that describes how
you can use <code>spatialLIBD</code> with public data sets provided by 10x Genomics.
That vignette is available at
<a href="http://research.libd.org/spatialLIBD/articles/TenX_data_download.html" class="external-link">http://research.libd.org/spatialLIBD/articles/TenX_data_download.html</a>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## The default arguments will download the data from the web</span></span></span>
<span class="r-in"><span><span class="co">## using fetch_data(). If this is the first time you have run this,</span></span></span>
<span class="r-in"><span><span class="co">## the files will need to be cached by ExperimentHub. Otherwise it</span></span></span>
<span class="r-in"><span><span class="co">## will re-use the files you have previously downloaded.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="enough_ram.html">enough_ram</a></span><span class="op">(</span><span class="fl">4e9</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co">## Obtain the necessary data</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"spe"</span><span class="op">)</span><span class="op">)</span> <span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="fetch_data.html">fetch_data</a></span><span class="op">(</span><span class="st">"spe"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## Create the interactive website</span></span></span>
<span class="r-in"><span>    <span class="fu">run_app</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## You can also run a custom version without the pseudo-bulked</span></span></span>
<span class="r-in"><span>    <span class="co">## layer information. This is useful if you are only interested</span></span></span>
<span class="r-in"><span>    <span class="co">## in the spatial transcriptomics features.</span></span></span>
<span class="r-in"><span>    <span class="fu">run_app</span><span class="op">(</span><span class="va">spe</span>,</span></span>
<span class="r-in"><span>        sce_layer <span class="op">=</span> <span class="cn">NULL</span>, modeling_results <span class="op">=</span> <span class="cn">NULL</span>, sig_genes <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">"spatialLIBD without layer info"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## When using shinyapps.io aim for less than 3 GB of RAM with your</span></span></span>
<span class="r-in"><span>    <span class="co">## objects. Check each input object with:</span></span></span>
<span class="r-in"><span>    <span class="co">## lobstr::obj_size(x)</span></span></span>
<span class="r-in"><span>    <span class="co">## Do not create the large input objects on the app.R script before</span></span></span>
<span class="r-in"><span>    <span class="co">## subsetting them. Do this outside app.R since the app.R script is</span></span></span>
<span class="r-in"><span>    <span class="co">## run at shinyapps.io, so subsetting on that script to reduce the</span></span></span>
<span class="r-in"><span>    <span class="co">## memory load is pointless. You have to do it outside of app.R.</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## How to run locally the spatialDLPFC Sp09 spatialLIBD app. That is,</span></span></span>
<span class="r-in"><span><span class="co">## from http://research.libd.org/spatialDLPFC/#interactive-websites</span></span></span>
<span class="r-in"><span><span class="co">## how to run https://libd.shinyapps.io/spatialDLPFC_Visium_Sp09 locally.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="enough_ram.html">enough_ram</a></span><span class="op">(</span><span class="fl">9e9</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co">## Download the 3 main objects needed</span></span></span>
<span class="r-in"><span>    <span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="fetch_data.html">fetch_data</a></span><span class="op">(</span><span class="st">"spatialDLPFC_Visium"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">sce_pseudo</span> <span class="op">&lt;-</span> <span class="fu"><a href="fetch_data.html">fetch_data</a></span><span class="op">(</span><span class="st">"spatialDLPFC_Visium_pseudobulk"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">modeling_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="fetch_data.html">fetch_data</a></span><span class="op">(</span><span class="st">"spatialDLPFC_Visium_modeling_results"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## These are optional commands to further reduce the memory required.</span></span></span>
<span class="r-in"><span>    <span class="co">#</span></span></span>
<span class="r-in"><span>    <span class="co">## Keep only the "lowres" images. Reduces the object from 6.97 GB to 4.59 GB</span></span></span>
<span class="r-in"><span>    <span class="co"># imgData(spe) &lt;- imgData(spe)[imgData(spe)$image_id == "lowres", ]</span></span></span>
<span class="r-in"><span>    <span class="co">## Drop the regular counts (keep only the logcounts). Reduces the object</span></span></span>
<span class="r-in"><span>    <span class="co">## from 4.59 GB to 2.45 GB.</span></span></span>
<span class="r-in"><span>    <span class="co"># counts(spe) &lt;- NULL</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## For sig_genes_extract_all() to work</span></span></span>
<span class="r-in"><span>    <span class="va">sce_pseudo</span><span class="op">$</span><span class="va">spatialLIBD</span> <span class="op">&lt;-</span> <span class="va">sce_pseudo</span><span class="op">$</span><span class="va">BayesSpace</span></span></span>
<span class="r-in"><span>    <span class="co">## Compute the significant genes</span></span></span>
<span class="r-in"><span>    <span class="va">sig_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="sig_genes_extract_all.html">sig_genes_extract_all</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sce_pseudo</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        modeling_results <span class="op">=</span> <span class="va">modeling_results</span>,</span></span>
<span class="r-in"><span>        sce_layer <span class="op">=</span> <span class="va">sce_pseudo</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## Reduce the memory from 423.73 MB to 78.88 MB</span></span></span>
<span class="r-in"><span>    <span class="fu">lobstr</span><span class="fu">::</span><span class="fu"><a href="https://lobstr.r-lib.org/reference/obj_size.html" class="external-link">obj_size</a></span><span class="op">(</span><span class="va">sig_genes</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">sig_genes</span><span class="op">$</span><span class="va">in_rows</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>    <span class="va">sig_genes</span><span class="op">$</span><span class="va">in_rows_top20</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>    <span class="fu">lobstr</span><span class="fu">::</span><span class="fu"><a href="https://lobstr.r-lib.org/reference/obj_size.html" class="external-link">obj_size</a></span><span class="op">(</span><span class="va">sig_genes</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## Specify the default variable</span></span></span>
<span class="r-in"><span>    <span class="va">spe</span><span class="op">$</span><span class="va">BayesSpace</span> <span class="op">&lt;-</span> <span class="va">spe</span><span class="op">$</span><span class="va">BayesSpace_harmony_09</span></span></span>
<span class="r-in"><span>    <span class="co">## Get all variables</span></span></span>
<span class="r-in"><span>    <span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## Set default cluster colors</span></span></span>
<span class="r-in"><span>    <span class="va">colors_BayesSpace</span> <span class="op">&lt;-</span> <span class="fu">Polychrome</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Polychrome/man/palettes.html" class="external-link">palette36.colors</a></span><span class="op">(</span><span class="fl">28</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">colors_BayesSpace</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">28</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">spe</span><span class="op">$</span><span class="va">BayesSpace_harmony_09</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">colors_BayesSpace</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">spe</span><span class="op">$</span><span class="va">BayesSpace_colors</span> <span class="op">&lt;-</span> <span class="va">spe</span><span class="op">$</span><span class="va">BayesSpace_harmony_09_colors</span> <span class="op">&lt;-</span> <span class="va">colors_BayesSpace</span><span class="op">[</span><span class="va">m</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## Download documentation files we use</span></span></span>
<span class="r-in"><span>    <span class="va">temp_www</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"www"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">temp_www</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"https://raw.githubusercontent.com/LieberInstitute/spatialDLPFC/main/README.md"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_www</span>, <span class="st">"README.md"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"https://raw.githubusercontent.com/LieberInstitute/spatialDLPFC/main/code/deploy_app_k09/www/documentation_sce_layer.md"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_www</span>, <span class="st">"documentation_sce_layer.md"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"https://raw.githubusercontent.com/LieberInstitute/spatialDLPFC/main/code/deploy_app_k09/www/documentation_spe.md"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_www</span>, <span class="st">"documentation_spe.md"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"https://raw.githubusercontent.com/LieberInstitute/spatialDLPFC/main/img/favicon.ico"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_www</span>, <span class="st">"favicon.ico"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"https://raw.githubusercontent.com/LieberInstitute/spatialDLPFC/main/code/deploy_app_k09/www/footer.html"</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_www</span>, <span class="st">"footer.html"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">temp_www</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## Run the app locally</span></span></span>
<span class="r-in"><span>    <span class="fu">run_app</span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="va">spe</span>,</span></span>
<span class="r-in"><span>        sce_layer <span class="op">=</span> <span class="va">sce_pseudo</span>,</span></span>
<span class="r-in"><span>        modeling_results <span class="op">=</span> <span class="va">modeling_results</span>,</span></span>
<span class="r-in"><span>        sig_genes <span class="op">=</span> <span class="va">sig_genes</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="st">"spatialDLPFC, Visium, Sp09"</span>,</span></span>
<span class="r-in"><span>        spe_discrete_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="co"># this is the variables for the spe object not the sce_pseudo object</span></span></span>
<span class="r-in"><span>            <span class="st">"BayesSpace"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"ManualAnnotation"</span>,</span></span>
<span class="r-in"><span>            <span class="va">vars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^SpaceRanger_|^scran_"</span>, <span class="va">vars</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>            <span class="va">vars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^BayesSpace_harmony"</span>, <span class="va">vars</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>            <span class="va">vars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^BayesSpace_pca"</span>, <span class="va">vars</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>            <span class="st">"graph_based_PCA_within"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"PCA_SNN_k10_k7"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"Harmony_SNN_k10_k7"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"manual_layer_label"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"wrinkle_type"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"BayesSpace_colors"</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>        spe_continuous_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            <span class="st">"sum_umi"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"sum_gene"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"expr_chrM"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"expr_chrM_ratio"</span>,</span></span>
<span class="r-in"><span>            <span class="va">vars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^VistoSeg_"</span>, <span class="va">vars</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>            <span class="va">vars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^layer_"</span>, <span class="va">vars</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>            <span class="va">vars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^broad_"</span>, <span class="va">vars</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>        default_cluster <span class="op">=</span> <span class="st">"BayesSpace"</span>,</span></span>
<span class="r-in"><span>        docs_path <span class="op">=</span> <span class="va">temp_www</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co">## See also:</span></span></span>
<span class="r-in"><span><span class="co">## * https://github.com/LieberInstitute/spatialDLPFC/tree/main/code/deploy_app_k09</span></span></span>
<span class="r-in"><span><span class="co">## * https://github.com/LieberInstitute/spatialDLPFC/tree/main/code/deploy_app_k09_position</span></span></span>
<span class="r-in"><span><span class="co">## * https://github.com/LieberInstitute/spatialDLPFC/tree/main/code/deploy_app_k09_position_noWM</span></span></span>
<span class="r-in"><span><span class="co">## * https://github.com/LieberInstitute/spatialDLPFC/tree/main/code/deploy_app_k16</span></span></span>
<span class="r-in"><span><span class="co">## * https://github.com/LieberInstitute/spatialDLPFC/tree/main/code/analysis_IF/03_spatialLIBD_app</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Leonardo Collado-Torres.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

