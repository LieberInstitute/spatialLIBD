# R for travis: see documentation at https://docs.travis-ci.com/user/languages/r

language: r

r: bioc-devel
warnings_are_errors: false
cache: packages
root: linux

deploy:
  provider: script
  script: Rscript -e 'pkgdown::deploy_site_github(verbose = TRUE, ssh_id = Sys.getenv("TRAVIS_DEPLOY_KEY", ""))'
  skip_cleanup: true

## Related to https://github.com/LTLA/BiocNeighbors/issues/10
install:
    - Rscript -e "remotes::install_version('RcppAnnoy', version = '0.0.14')"

r_packages:
  - covr
  - pkgdown

r_build_args: "--no-manual --no-resave-data"
r_check_args: "--no-build-vignettes --no-manual --timings"

after_success:
  - Rscript -e 'library(covr); codecov()'

notifications:
  email:
    on_success: change
    on_failure: change
  slack:
    secure: oAMMkWwjP9RVGrgxtzAo3pHi8eYgWIBOblcPo6hrjgR8YAlBU7WsVQdyuVbgfsW2a7L7BBNuw0/zKqAJ9GxgLeZtnZ6ddo/VhO1XOldvmY2Ne1EmI5x2EqQaLA8B/smFe0x52nSYWV8RGmJUQ75yDPAcE0Zyx0xYzT66/zxC/1NpIKQ/C6NHdwVyRdCUEtfKkjb6hV222qOzbc5AhWrle7PL3hzM/4eGmJ0fJGG9nshCupMxn5PFHl7JqylVKhDpI0kk+iaiHG1L2WfR8drYpuWNbUkUlo5VwoZodYQpPW9y+g1iarq5b2U9l5ODthLiP3gTU9BJFX8LaLZd7ZdvBD13GtOekijRC6Nu2KN/YQ462WwBI0wIPqkYO94AExmTH2jWLsWQ4r6lPeU7gzbhFIT+jDKgKCWZ/7VM1Gatns7TPGcQ6jZPjwtsFCgg4y7HvoCYvwp9YdL1y7TOjEIHqAaa3aLhfDxnh/6mBJA3GeS7jn3565ObSLNKGISFCERBclWSqs0DDSwCxPfGdN176/ctNd6/8vDYb74O/Zxovyd9E9009NRNzzrvbc9HaxHU1LX9ZFAsWZy/5/5s8+7OCtAQ/z9RT2jv3S6Ym3pZTXcRwCe6DytuFMx55/7nsiLgDIPOJ30mMfHxYOmr+yblr9qgGT4vG6Elpg16innrqzs=

env:
  global:
    - _R_CHECK_TIMINGS_="0"
