% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/registration_pseudobulk.R
\name{registration_pseudobulk}
\alias{registration_pseudobulk}
\title{Spatial registration: pseudobulk}
\usage{
registration_pseudobulk(sce, var_registration, var_sample_id, covars = NULL)
}
\arguments{
\item{sce}{A
\link[SingleCellExperiment:SingleCellExperiment]{SingleCellExperiment-class}
object.}

\item{var_registration}{A \code{character(1)} specifying the \code{colData(sce)}
variable of interest against which will be used for computing the relevant
statistics.}

\item{var_sample_id}{A \code{character(1)} specifying the \code{colData(sce)} variable
with the sample ID.}

\item{covars}{A \code{character()} with names of sample-level covariates.}
}
\value{
A pseudo-bulked \link[SingleCellExperiment:SingleCellExperiment]{SingleCellExperiment-class} object.
}
\description{
Pseudo-bulk the gene expression, filter lowly-expressed genes, and normalize.
This is the first step for spatial registration and for statistical modeling.
}
\examples{

## Generate example data
sce <- scuttle::mockSCE()

## Add some sample IDs
sce$sample_id <- sample(LETTERS[1:5], ncol(sce), replace = TRUE)

## Add a sample-level covariate: age
ages <- rnorm(5, mean = 20, sd = 4)
names(ages) <- LETTERS[1:5]
sce$age <- ages[sce$sample_id]

## Add gene-level information
rowData(sce)$ensembl <- paste0("ENSG", seq_len(nrow(sce)))
rowData(sce)$gene_name <- paste0("gene", seq_len(nrow(sce)))

## Pseudo-bulk
sce_pseudo <- registration_pseudobulk(sce, "Treatment", "sample_id", c("age"))
colData(sce_pseudo)

## For tests
# sce$batches <- sample(1:3, ncol(sce), replace=TRUE)
# sce_pseudo <- registration_pseudobulk(sce, "Treatment", "sample_id", c("age", "batches"))

}
\seealso{
Other spatial registration and statistical modeling functions.: 
\code{\link{registration_block_cor}()},
\code{\link{registration_model}()},
\code{\link{registration_stats_anova}()},
\code{\link{registration_stats_enrichment}()},
\code{\link{registration_stats_pairwise}()}
}
\concept{spatial registration and statistical modeling functions.}
